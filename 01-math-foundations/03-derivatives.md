# 미분 (Derivatives)

## 왜 필요한가?
딥러닝은 손실 함수(loss function)를 최소화하는 과정이다. 미분은 "어떤 방향으로 가중치를 바꾸면 손실이 줄어드는가?"를 알려주는 도구다. 그래디언트 디센트(gradient descent)의 수학적 기반.

---

## 1. 미분이란?
함수의 **순간 변화율**. 그래프에서 한 점의 **기울기(slope)**.

$f(x) = x^2$

$x=3$에서의 기울기:

$$f(3) = 9, \quad f(3.001) = 9.006001$$

$$\text{변화율} \approx \frac{9.006001 - 9}{3.001 - 3} = 6.001 \approx 6$$

미분 표기: $f'(x)$ 또는 $\dfrac{df}{dx}$

## 2. 기본 미분 공식

| 함수 $f(x)$ | 도함수 $f'(x)$ | 예시 |
|-----------|-------------|------|
| $c$ (상수) | $0$ | |
| $x^n$ | $nx^{n-1}$ | $x^2 \to 2x$, $x^3 \to 3x^2$ |
| $e^x$ | $e^x$ | 지수함수는 미분해도 자기 자신 |
| $\ln(x)$ | $1/x$ | |
| $\sin(x)$ | $\cos(x)$ | |

## 3. 미분의 규칙

**합의 미분**: $(f + g)' = f' + g'$

$$f(x) = x^2 + 3x \;\to\; f'(x) = 2x + 3$$

**곱의 미분**: $(f \times g)' = f' \times g + f \times g'$

**상수 곱**: $(c \times f)' = c \times f'$

$$f(x) = 5x^3 \;\to\; f'(x) = 15x^2$$

## 4. 편미분 (Partial Derivative)
변수가 여러 개인 함수에서, **하나의 변수만** 미분하고 나머지는 상수 취급.

$$f(x, y) = x^2 + 3xy + y^2$$

$$\frac{\partial f}{\partial x} = 2x + 3y \quad \text{(y는 상수 취급)}$$

$$\frac{\partial f}{\partial y} = 3x + 2y \quad \text{(x는 상수 취급)}$$

딥러닝에서:
- 손실 함수 $L$은 모든 가중치 $w_1, w_2, \ldots, w_n$의 함수
- $\frac{\partial L}{\partial w_1}$은 "$w_1$을 살짝 바꾸면 Loss가 얼마나 변하는가?"를 의미
- 각 가중치에 대한 편미분을 계산 → 그래디언트

## 5. 그래디언트 (Gradient)
모든 편미분을 벡터로 모은 것. **가장 가파르게 올라가는 방향**을 가리킨다.

$$f(x, y) = x^2 + y^2$$

$$\nabla f = \left[\frac{\partial f}{\partial x},\; \frac{\partial f}{\partial y}\right] = [2x,\; 2y]$$

$(x, y) = (3, 4)$일 때: $\nabla f = [6, 8]$
- 이 방향으로 가면 $f$가 가장 빠르게 증가
- 반대 방향($-\nabla f$)으로 가면 $f$가 가장 빠르게 감소 (= 최소화)

이것이 **그래디언트 디센트**의 핵심 아이디어:

$$w_{\text{new}} = w_{\text{old}} - \eta \cdot \nabla L$$

## 6. 수치 미분 (Numerical Differentiation)
공식을 모를 때, 아주 작은 변화를 줘서 미분을 **근사**하는 방법.

$$f'(x) \approx \frac{f(x + h) - f(x - h)}{2h} \quad \text{(h는 아주 작은 수, 예: 0.0001)}$$

PyTorch의 autograd가 이 과정을 자동으로, 정확하게 해준다.

---

## 핵심 정리
1. **미분** = 함수의 변화율. 신경망 학습의 수학적 기반
2. **편미분** = 여러 변수 중 하나만 미분. 각 가중치가 Loss에 미치는 영향
3. **그래디언트** = 모든 편미분의 벡터. 가장 가파른 상승 방향
4. **그래디언트 디센트** = 그래디언트의 반대 방향으로 이동 → 손실 최소화

---

## 실습 과제
1. $f(x) = 3x^2 + 2x + 1$을 미분하고, $x=2$에서의 기울기를 구해보기
2. $f(x, y) = x^2 y + xy^2$의 편미분을 각각 구해보기
3. 수치 미분으로 $f(x) = x^3$의 $x=2$에서의 기울기를 계산해보기 ($h=0.0001$ 사용)

---
